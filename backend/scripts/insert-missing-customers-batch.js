/**
 * One-off: insert ONLY the missing customers batch (FOXY JEWEL GALLERY through INTERNATIONAL FRANCHISES).
 * Run from backend/backend: node scripts/insert-missing-customers-batch.js
 * Requires .env with CONNECTION_STRING or MONGODB_URI.
 */
const path = require("path");
require("dotenv").config({ path: path.join(__dirname, "..", ".env") });
if (!process.env.CONNECTION_STRING && !process.env.MONGODB_URI) {
  require("dotenv").config({ path: path.join(__dirname, "..", "..", ".env") });
}

const mongoose = require("mongoose");
const bcrypt = require("bcryptjs");
const User = require("../models/User");
const Customer = require("../models/Customer");

const MONGODB_URI = process.env.CONNECTION_STRING || process.env.MONGODB_URI;
const COMPANY_ID = "RESSICHEM";
const COUNTRY = "Pakistan";

const BULK_DATA = `
FOXY JEWEL GALLERY FoxyJewelgallery@123 STREET # 6, NATIONAL STADIUM, A.O.H.S., KARACHI. 0331-2641339 SINDH
FRIEND ENTERPRISES Friendenterprises@123 PLOT # 48/C, 22ND COMMERCIAL STREET, PHASE-II Ext. D.H.A, KARACHI. 0300-2278392 SINDH
FUTURE POWER (SMC-PRIVATE) LIMITED FUTURE.power@123 FLAT C-2/3, GULSHAN HAIDERY APARTMENTS, BLOCK 3, GULSHAN-E-IQBAL, KARACHI. 0300-0458675 SINDH
G.N FUS G.Nfus@123 MR 2/36-37, MARRIOT ROAD, 0300-2206252 SINDH
GALAXY DESIGNER ( DIGITAL ) GALAXY.designer@123 Progressive square Main Shahra-e-Faisal, KARACHI. 0318-3113715 SINDH
GARDEN ICON ( DIGITAL ) GARDEN.icon@123 PLOT # 129/1, MANIKJEE STREET,GARDEN EAST, Karachi East Jamshed Town. ZEESHAN SB # 0321-2758642 0321-9277542 SINDH
GEO CON CONSTRUCTION & CONSULTANTS ( DIGITAL ) Consultantsdigital@123 main Abul Hasan Isphani road, near PS Mubeena Town, Paradise bakers, Karachi. ABDUS SALAM SB # 0332-9266999 / 0321-2559685 0332-9266999 SINDH
GHAFFAR KHAN (NEW PAK PAINTS H/W, SANITARY & ELECTRIC STORE) GHAFFAR.khan@123 SHOP # 3, JOHAR HOME, BLOCK 13-B, GULSHAN-E-IQBAL, KARACHI. 0333-3131552 SINDH
GHANCHI STEEL Ghanchisteel@123 SHOP # 02, 730/10 STEEL MARKET, SIR SHAH SULEMAN Rd., LIAQUATABAD, KARACHI. 0321-9295953 SINDH
GHAZI BROTHERS Ghazibrothers@123 HOUSE NO. D-35, KDA SCHEME NO. 1, MIRAN MUHAMMAD SHAH ROAD, KARACHI. GHAZIBROTHERS@gmail.com SINDH
GHAZI PAINT HOUSE ( RETAIL ) GHAZI.painthouse@123 Shop No 01 Plot No 37-E, Badar Commercial Street No 07, Phase-V EXT DHA, Karachi. M.WASIM SB # 0312-0155550 0312-0155550 SINDH
GHORI TRADERS ( RETAIL ) GHORI.traders@123 SHOP # 1-A14, MALIK SOCIETY, GULZAR-E-HIJRI, KARACHI. 0313-2660012 SINDH
GHOUSIA CONSTRUCTION Ghousiaconstruction@123 R-10, BHATTI COLONY SECTOR A KORANGI CROSSING ,KARACHI 0301-2221187 SINDH
GHULAM FAROOQ RIND BALOCH GhulamFarooqRindbaloch@123 QASMANI MANZIL 4 FLOOR, FLAT # RC-4/4, RANCHOR LINE, KARACHI. 0333-2070638 SINDH
GHULAM HUSSAIN CO CONT. AZHAR MUFADDIL GhulamHussainCoCont.Azharmufaddil@123 HOUSE NO.01, street no.1, OBAWARA JANUBI, Multan Cantt., Jalalpur Pirwala. 0334-3859251 PUNJAB
GHULAM M. SAMOON C/O AWAN CERAMIC GhulamM.SamoonC/OAwanceramic@123 Plot # A-14, KDA, SCHEME 1, KARACHI 0333-0382257 SINDH
GHULAM MUHAMMAD SB GhulamMuhammadsb@123 GOTH MUHAMMAD HASHIM BUTHAN, DAKHANA GHOTKI, ZILA GHOTKI. 0302-2508800 SINDH
GHULAM MURTAZA ( DIGITAL ) GHULAM.murtaza@123 SELF PICK 0321-2105420 SINDH
GHULAM MUSTAFA Ghulammustafa@123 N-4242, METROVILLE III, BLOCK 1, SCHEME 33, Malir Gadap Town, Karachi. 0321-2276981 SINDH
GHULAM MUSTAFA ( M. JUMAN FUNITURE HARDWARE STORE ) M.JumanFunitureHardwarestore@123 NEAR LAAL BUILDING MARKET ROAD NO. 2, NAWABSHAH 0300-3239753 SINDH
GHULAM MUSTAFA GHANCHI ( MAGS ENTERPRISE ) Magsenterprise@123 PLOT # 205, LOVE LANE ROAD, GARDEN WEST, KARACHI. 0300-9232001 SINDH
GHULAM QASIM ( QASIM FLOORING ) Qasimflooring@123 SHOP # 34, SALEEM CENTRE NEAR TELEPHONE EXCHANGE, UNIVERSITY ROAD, GULSHAN-E-IQBAL, BLOCK-13, KARACHI. 0301-2932023 SINDH
GHULAM RABBANI ( RPL ) Rabbanirpl@123 REKSAR LINE, HASSAN AULIYA VILLAGE, MANGHOPIR Rd., KARACHI WEST. 0321-2896461 SINDH
GILANI CONSTRUCTORS Gilaniconstructors@123 NAVAL ACADEMY, PNS RAHBAR, MANORA, KARACHI. 0300-6345495 SINDH
GLOBAL DECOR (PRIVATE) LIMITED GLOBAL.decor@123 NASEER AHMED, MAIN WAISA Rd. VILL & P.O WAISA TEHSIL HAZRO DIST, ATTOCK, PUNJAB. 0314-5100033 PUNJAB
GLOVER SPORTS ( MUHAMMAD AYAZ ANWAR SB ) MuhammadAyazAnwarsb@123 H.NO. 17/172, DARA ARAIN, NEAR HAVELI MOLVIAN MOH. MIANA PURA, SIALKOT. 0321-7141986 PUNJAB
GM & SONS Gm&sons@123 SHOP NO. 14, MAIN BADIN HYDERABAD, ROAD, TANDO MUHAMMAD KHAN TANDO MUHAMMAD KHAN. 0300-2863426 SINDH
GODIL COLDCHAIN (PRIVATE) LIMITED GODIL.coldchain@123 PLOT # 148, SECTOR 23, KORANGI INDUSTRIAL AREA, KARACHI. 0323-2107570 SINDH
Gogan Cement Gogancement@123 244/B, Lehra Square, Shop # 15, Opp. Karimi Mosque, Block-6, PECHS, 0300-8921330 SINDH
GOHAR ALI ( ABID HARDWARE & PAINT STORE ) AbidHardware&Paintstore@123 MADYAN ROAD, MINGORA, SAWAT. 0300-5740782 KPK
GOLDEN TRADERS Goldentraders@123 R.C.C. PLOT # 28, OPP BEACON HOUSE SCHOOL, QASIMABAD, 0301-8370183 SINDH
GOLRA SHARIF INTERPRISES GolraSharifinterprises@123 Silkcoat show room, Javed Plaza Opposite Gate No 2, DHA Phase 2, Near Zic Petrol Pump, Rawalpindi. 0300-5509606 PUNJAB
GOODRAYS STEEL FABRICATORS GoodraysSteelfabricators@123 C 1/5 Sector 9E Orangi Town Karachi, orangi, Orangi Town # 5, Karachi. 0333-2289438 SINDH
GOOMAL WAZIRISTAN HOTEL ( RETAIL ) GOOMAL.waziristanhotel@123 KATHOR TRUCK STAND, NEAR BAHRIA TOWN, KARACHI. 0306-8555621 SINDH
GRAVITY BUILDERS & DEVELOPERS GravityBuilders&developers@123 PLOT # D-139/2, BLOCK-4, CLIFTON, KARACHI. 0300-2246445 SINDH
GREEN TECHNOLOGIES Greentechnologies@123 PLAZA NO 61-CCA, 2ND FLOOR, EXT PARK VIEW, DEFENCE HOUSING AUTHORITY, LAHORE 0300-2733333 PUNJAB
GREENLEAF CONSTRUCTION (PRIVATE) LIMITED GREENLEAF.construction@123 Plot no. G-6, KDA Scheme-5, Clifton Block-9, KARACHI. 0300-2423933 SINDH
GUARANTEE ENGINEERS (PVT) LTD ( DIGITAL ) GuaranteeEngineers(Pvt)Ltd(Digitaldigital)@123 ELAHI ARCADE, 26- EMPRESS ROAD, EMPRESS ROAD, Lahore Data Gunj Bukhsh Town 0300-4476948 PUNJAB
GULF BUILDING MATERIAL GulfBuildingmaterial@123 Plot#: L4, ST 1/1, Sector-25, Korangi Industrial Area Karachi 0300-3979959 SINDH
GULF CONSTRACTORS (PRIVATE) LIMITED GULF.constractors@123 GETZ PHARMA, PLOT # 01, SECTOR # 25, NEAR VITA CHOWRANGI, KORANGI INDUSTRIAL AREA 0300-8285947 SINDH
GULF ENTERPRISES Gulfenterprises@123 OFFICE # 13, QUAID E AZAM MARKET, ASLAM MARKET, WAH CANTT, TAXILA. 0301-5431988 PUNJAB
GULSHAN TILE Gulshantile@123 SHAH FAISAL COLONY NO 2 0300-7011031 SINDH
GW ALPHA Gwalpha@123 ASD, Alpha 4, NASTP, Old Airport, Chaklala Cantt, Rawalpindi. 0320-5612998 PUNJAB
H&H CONSTRUCTION H&Hconstruction@123 2nd FLOOR, F-42, BLOCK-F, PHASE-1, DHA, LAHORE 0321-4579640 PUNJAB
H&K PROPERTIES (PRIVATE) LIMITED H&K.properties@123 OFFICE NO. 4, GROUND FLOOR, PLOT NO. 6-C, STREET NO. 34, TAUHEED COMMERCIAL AREA, PHASE-V, DEFENCE OFFICERS HOUSING AUTHORITY, KARACHI 0345-6004032 SINDH
H.B.POWER TOOL H.B.Powertool@123 PLOT C-220, SECTOR 27 KORANGI INDUSTRAIL AREA, KORANGI INDUSTRIAL AREA, KARACHI. 0321-2196145 SINDH
H.I.S Builders ( DIGITAL ) Buildersdigital@123 Plot No. 8-C, Murtaza Commercial Lane-1, DHA Phase VIII, KARACHI. 0321-2432169 SINDH
H.ISMAIL & SONS H.Ismail&sons@123 SELF PICK 0300-8247966 SINDH
H.S Builders and Developers H.SBuildersAnddevelopers@123 KARACHI 0317-2195155 SINDH
HABIB & CO Habib&co@123 PLOT NO.14-C,1st FLOOR, 14th COMMERCIAL STREET, PHASE-2, DEFENCE HOUSING AUTHORITY, KARACHI. 0321-8286553 SINDH
HABIB ULLAH ( ASLAM BROTHERS PAINT STORE ) AslamBrothersPaintstore@123 SAR CALAR Rd. O/SIDE PARETY GATE BANNU CITY. 0333-9723593 PUNJAB
HABIB ULLAH KHAN SB ( CHANAB CORP. ) Chanabcorp.@123 KACHARI Rd., JHANG SADDAR Rd, JHANG. 0313-5466183 PUNJAB
HABIB UR RAHMAN ( HASEEB HARDWARE ) Haseebhardware@123 Badozai road, Block G Fatima Jinnah Town, Multan 0300-6302551 PUNJAB
HABIB UR REHMAN ( NAYAB ELECTRONICS & MOTOR WINDING ) NayabElectronics&Motorwinding@123 S.D.A. MARKET, GADOON AMAZAI. 0301-5914927 PUNJAB
HAFEEZ SHEIKH ( DIGITAL ) HAFEEZ.sheikh@123 BILTY HYDERABAD. 0300-4902396 SINDH
HAFEEZ ULLAH SB ( LILLAH MARBEL ) Lillahmarbel@123 PLOT # AW-1, AW-2, PUNJAB SMALL INDUSTRIAL LAHORE ROAD, SARGODHA. 0300-6043788 PUNJAB
HAFIZ ENGENERING WORKS HafizEngeneringworks@123 87-M, DENIM ROAD, KOT LAKHPAT INDUSTRIAL AREA, LAHORE. 0306-1409147 PUNJAB
HAFIZ FARAZ ALI HafizFarazali@123 HOUSE #540, STREET-22, PUNJAB COLONY NEAR ADAMJI COACHING CENTER, OPP. ALTAMASH DENTAL HOSPITAL, CLIFTON, KARACHI. 0347-0284520 SINDH
HAFIZ IMRAN ( DIGITAL ) HAFIZ.imran@123 SATRAH CHOWK PASRUR, SIALKOT. 0307-3374768 PUNJAB
HAFIZ M. HANZLA AHMAD SB HafizM.HanzlaAhmadsb@123 SHOP NO-LG-9, KHYBER BARA MARKET, PRI MEHEL, SHAHALAM MARKET, LAHORE. 0300-6680724 PUNJAB
HAFIZ MUHAMMAD BASHEER UDDIN ( DIGITAL ) Uddindigital@123 RAWALPINDI MUSLIM GIRLS SCHOOL SERVICE ROAD NEAR SHAHEEN PIPE SALE OFFICE PANJAB. 0332-5234274 PUNJAB
HAFIZ MUHAMMAD KASHIF ( DIGITAL ) HAFIZ.muhammadkashif@123 R-30, TARIQ BIN ZYAD SOCIETY PROJECT MALIR HALT, KARACHI. 0316-2396872 SINDH
HAFIZ QAMAR MAHMOOD HafizQamarmahmood@123 KOTLI HAJI PUR, TEHSIL PASRUR, DISTRICT SIALKOT. 0337-1464601 PUNJAB
HAFIZ SABIH ( DIGITAL ) HAFIZ.sabih@123 SELF PICK 0312-0386563 SINDH
HAFIZ USMAN ALI HafizUsmanali@123 64 12 KORANG TOWN, ISLAMABAD. 0311-1333969 CAPITAL TERRITORY
HAJI ABDUL KHALIQ & SONS HajiAbdulKhaliq&sons@123 UG-110 B, DEANS TRADE CENTER, SADDAR ROAD, PESHAWAR 0333-9192508 KPK
HAJI GUL ENTERPRISES HajiGulenterprises@123 PLOT NO. 759 & 760, SHIREEN JINNAH COLONY, CLIFTON, KARACHI. 0301-7777799 SINDH
HAJI MOHAMMAD SHAFI & SONS HajiMohammadShafi&sons@123 BAGHPATEE TRADE TOWER, ALTAF HUSSAIN ROAD, NEW CHALI, KARACHI SOUTH LYARI TOWN 0335-3446602 SINDH
HAJI MUHAMMAD ASHRAF ( DIGITAL ) HAJI.muhammadashraf@123 P110 STREET 10A MUHAMMADIA COLONY SARGODHA 0321-5193920 PUNJAB
HAJI SALEEM Hajisaleem@123 HYDERABAD, BILTY FROM A-ONE GOODS TRANSPORT 0300-9376413 SINDH
HAJI SYED M. AUTOS MOBILE AND PARTS ( RETAIL ) Partsretail@123 Gate no 4, Gali no 4 New Quaid e Azam truck stand Hawksby road Muaripur, KARACHI. 0335-2262262 SINDH
HAJRA DYEING MILLS HajraDyeingmills@123 PLOT 66-67-68, SECTOR 24, KORANGI INDUSTRIAL AREA, KARACHI. 0300-9271389 SINDH
HALCROW PAKISTAN (PRIVATE) LIMITED HALCROW.pakistan@123 BUSINESS ENCLAVE, 12th COMMERCIAL ST, PHASE-2, COMMERCIAL AREA D.H.A, KARACHI. 0318-3100257 SINDH
HAMAYUN SULTAN Hamayunsultan@123 OFFICE NO.2, 9TH FLOOR, SHARJAH TRADE CENTER, NEW CHALI ALTAF HUSSAIN ROAD, KARACHI. 0341-7778888 SINDH
HAMEED SONS Hameedsons@123 LOHA BAZAR ,VEHARI. 0301-1044368 PUNJAB
HAMMAD AHMED SB HammadAhmedsb@123 KARACHI 0300-8261037 SINDH
HAMMER TRADING Hammertrading@123 SHOP # 1, WS-49 SECTOR 16-B, NORTH KARACHI INDUSTRIAL AREA, KARACHI. 0321-2476150 SINDH
HAMNA FAJAR ( DIGITAL ) HAMNA.fajar@123 BILTY GUJRANWALA. 0348-8120787 PUNJAB
HAMZA CO RASHEED HamzaCorasheed@123 HOUSE # 65, 6th STREET, D.H.A. PH-4, KARACHI. 0330-8217575 SINDH
HAMZA JAVED SB HamzaJavedsb@123 DAAK-KHANA CHARWAH, GOGYAL, DIST. PASROOR, SIALKOT 0309-1668902 PUNJAB
HAMZA MEHMOOD ( DIGITAL ) HAMZA.mehmood@123 SHOP NO 1, KHATIJA TAI ARCATE MAIN KHALID BIN WALID ROAD P.E.C.S.H. KARACHI. 0336-7742692 SINDH
HAMZA NASIR CO MAKKAH STATIONERS ( RETAIL ) Stationersretail@123 SHOP # 42, URDU BAZAR, KARACHI. 0323-2263246 SINDH
HAMZA SHABBIR HUSSAIN HamzaShabbirhussain@123 SELF PICK 0336-3812598 SINDH
HANI PRINTERS Haniprinters@123 HOUSE NO.380, SEC10/L, ORANGI TOWN, KARACHI. 0324-2806918 SINDH
HANIF BANGLES Hanifbangles@123 KORANGI, NEAR CHINIOT HOSPITAL, OPP. SAJJAD BANGLES, 0316-2516103 SINDH
HANIF BROTHERS HARDWARE HanifBrothershardware@123 GUNJ GATE NEAR BAANO STOP CIRCULAR ROAD, PESHAWAR. 0333-9697095 KPK
HANZLA MUNIR Hanzlamunir@123 SUSAN ROAD, NEAR ZAINAB MASJID, FAISALABAD. 0322-6201677 PUNJAB
HARESH KUMAR LOHANA HareshKumarlohana@123 SHOP NO 15-16, JHALAWAN MARKET, MAIN RCD ROAD, LASBELA HUB. 0301-2330669 BALOCHISTAN
HARIS KHAN ( DIGITAL ) HARIS.khan@123 SELF PICK 0331-0375605 SINDH
HARMAIN BUILDERS (BURJ UL HARMAIN) Ulharmain@123 NEAR RIMGHIM TOWER, SAFOORA CHOWRANGI 0301-2630256 SINDH
HAROON PAINTS AND INDUSTRIAL COATINGS HaroonPaintsAndIndustrialcoatings@123 E-458, UMER ROAD, RAWALPINDI. 0333-5109540 PUNJAB
HAROON RAFIQ ( DIGITAL ) HAROON.rafiq@123 MADINA TOWN NO I OPPOSITE NATIONAL BANK OF PAKISTAN OLD SHUJAHABAD ROAD BRANCH STREET NO 2 NEAR IRFAN KARYANA STORE, MULTAN. 0306-3075966 PUNJAB
HAROON RASHEED ( AL MADINA HARDWARE ) AlMadinahardware@123 HOUSE # 277, STREET-5, ERUM COLONY, MARDAN. 0314-6004394 KPK
HAROON SHEIKH ( H. CONE CONSTRUCTION ) H.Coneconstruction@123 BAHRIA HEIGHT-F, BAHRIA TOWN, KARACHI. 0303-3711514 SINDH
HAROON TRADING CO. HaroonTradingco.@123 PO BOX 1926, DUBAI, U.A.E HAROONTRADINGCO.@gmail.com EXPORT
HASAN SB ( HASAN BROTHERS ) Hasanbrothers@123 SHOP # 142, NEAR DAKKHANA SHEESHMAHAL, LIAQUATABAD, KARACHI 0311-0217679 SINDH
HASEEB KHAN ( DIGITAL ) HASEEB.khan@123 BILTY NOWSHERA VIA PESHAWAR LAHORE GOODS 0321-9753007 KPK
HASEEB UR REHMAN ( ANSAR AND BROTHERS ) AnsarAndbrothers@123 MARRIOTT ROAD, DOUBLE CHAMBER, KARACHI. 0300-2459924 SINDH
HASHIM SAIFUDDIN ( HAKIMI ART AND CRAFT ) HakimiArtAndcraft@123 SHOP NO 02, GROUND FLOOR, AYUB MANZIL, ARTILLERY MAIDAN QUATER, URDU BAZAR, KARACHI. 0336-6852910 SINDH
HASNAIN BUILDERS ( DIGITAL ) HASNAIN.builders@123 BILTY LAHORE 0301-7306187 PUNJAB
HASNAIN MUJTABA ( DIGITAL ) HASNAIN.mujtaba@123 SELF PICK 0331-3535175 SINDH
Hassam sb ( digital ) Hassam.sb@123 KARACHI 0341-3151217 SINDH
HASSAN & BROTHERS Hassan&brothers@123 SHOP NO. 2, PLOT NO. 1240, GULBAHAR NO. 1, GOLIMAR, KARACHI. 0334-1026634 SINDH
HASSAN ALI SB ( MUX ) Muxmux@123 PLOT # 7-C, PHASE-1, INDUSTRIAL ESTATE, MULTAN. 0304-4819016 PUNJAB
HASSAN ENTERPRISES Hassanenterprises@123 TOWER-E, BAHRIA HEIGHTS, KARACHI. 0324-4324541 SINDH
HASSAN IJAZ SB ( GRAVITY ENGINEERING ) Gravityengineering@123 163C-N, GHAZALI ROAD, OPP. KHIZRA MASJID, SHOP # 11, KHIZAR CENTER, SAMANABAD, LAHORE. 0321-4213557 PUNJAB
HASSAN LATIF JAMAL HassanLatifjamal@123 5/1-A STREET PHASE-5, D.H.A, KARACH 0342-8043390 SINDH
HASSAN MEHAR ( DIGITAL ) HASSAN.mehar@123 BILTY SAWAT 0315-0770078 KPK
HASSAN NADEEM ( AL REHMAN SANITARY ) AlRehmansanitary@123 14 JUNAID PLAZA, BLOCK-6, GULSHAN-E-IQBAL, MAIN RASHID MINHAS ROAD, KARACHI 0300-2661019 SINDH
HASSAN SHAHID ( PARAS CHEMICAL ) Paraschemical@123 8-A, Sitara Market, Satyana Road, Faisalabad Iqbal Town 0315-9908096 PUNJAB
HASSAN TARIQ ( HASSAN HARDWARE ) Hassanhardware@123 SHOP NO. 2, PLOT NO. 1240, GULBAHAR NO. 1, GOLIMAR, KARACHI. 0334-1026634 SINDH
HAYAT BUILDERS AND DEVELOPERS HayatBuildersAnddevelopers@123 HOUSE NO. 15-D, GOLF COURSE ROAD NO.2, PHASE IV, DHA, KARACHI. 0321-3011393 SINDH
HAZARI ENTERPRISE Hazarienterprise@123 1/14, MARRIOT ROAD, 0300-9214304 SINDH
HAZARI IMPEX Hazariimpex@123 M-R 2/43 GRD, FLOOR MARRIOT ROAD, KARACHI, Karachi South Saddar Town 0300-9223490 SINDH
HAZIBULLAH SB Hazibullahsb@123 543, STREET NO. 42, BLOCK-C, ALAMGIR ROAD, SHERSHAH COLONY, KARACHI. 0302-5271098 SINDH
HAZRAT ULLAH C/O HAJI KHEER BLOCK WORK HazratUllahC/OHajiKheerBlockwork@123 PLOT # A-29/, BLOCK-B, NORTH NAZIMABAD, OPP. IQRA UNIVERSITY, KARACHI. 0300-2398804 SINDH
HBR TEXTILE ( DIGITAL ) HBR.textile@123 Vehari road, near Gernal Bus stand , MULTAN. 0303-6666113 PUNJAB
HEERA ART STORE ( RETAIL ) HEERA.artstore@123 SHOP NO. 3, 4, PLOT NO.21, BLOCK-2, OPP: WORLD MEMON FOUNDATION, HUSSAINABAD, F.B AREA, KARACHI. 0321-2239953 SINDH
HELIX PHARMA (PRIVATE) LIMITED HELIX.pharma@123 HAKIMSONS HOUSE, A/56 S.I.T.E, MANGHOPIR ROAD, KARACHI. 0335-3039741 SINDH
HISTONE ISLAMABAD(PRIVATE) LIMITED HISTONE.islamabad@123 2nd FLOOR, PLAZA 7, COMMERCIAL 1, NAVAL ANCHORAGE ISLAMABAD HIGHWAY ISLAMABAD. 0322-2408836 CAPITAL TERRITORY
HM SQUARE Hmsquare@123 SUITE NO. 63, GROUND FLOOR, NOMAN CENTRE, BLOCK NO. 5, KARACHI. 0321-8212784 SINDH
HOME LIVING Homeliving@123 NO. 221-A, ROAD NO. 1, OPPOSITE IDEAS BY GUL AHMED, BLOCK A, PWD SOCIETY, ISLAMABAD. 0300-9147238 CAPITAL TERRITORY
HORIZON SOURCING (PRIVATE)LIMITED HORIZON.sourcing@123 PLOT NO. 20, 21 & 25, SECTOR 26, KORANGI INDUSTRIAL AREA, KARACHI. 0300-8267574 SINDH
HOSTACHEM INTERNATIONAL Hostacheminternational@123 PLOT NO. 521-522, SECTOR 7-A, KORANGI INDUSTRIAL AREA, KORANGI, KARACHI. 0346-3586741 SINDH
HOTEL CROWN PLAZA ISLAMABAD (PRIVATE) LIMITED HOTEL.crownplazaislamabad@123 99-E JINNAH AVENUE MAIN BLUE AREA, ISLAMABAD. 0300-5106666 CAPITAL TERRITORY
HUMA ATIF Humaatif@123 HOUSE # 546, STREET # 14-B, SEC-B, ASKARI-14, RAWALPINDI. 0333-6518870 PUNJAB
HUMAIRA PARWAIZ ( DIGITAL ) HUMAIRA.parwaiz@123 SELF PICK 0313-2401994 SINDH
HUMAYON ASSOCIATES Humayonassociates@123 HOUSE # 271, BLOCK- H-1 M A, JOHAR TOWN, LAHORE. 0301-4166665 PUNJAB
HUMAYUN CHEMICALS Humayunchemicals@123 59-CIRCULAR ROAD, O/S AKBARI GATE, LAHORE. 0321-8415733 PUNJAB
HUMAYUN MAHSUD ( DIGITAL ) HUMAYUN.mahsud@123 ISLAMABAD 0336-5194414 CAPITAL TERRITORY
HUMZA ALI ( DIGITAL ) HUMZA.ali@123 SELF PICK 0300-2532852 SINDH
HUNZA ENTERPRISES Hunzaenterprises@123 MAIN ZULFIQAR AVENUE, PHASE-8, NEAR TOTAL PETROL PUMP, KARACHI. 0312-1277234 SINDH
HUSAINITECH HUSAINITECH@123 HAQQANI CHOWK, PAPER MARKET, KARACHI. 0343-2688106 SINDH
HUSNAIN LOTIA Husnainlotia@123 D-196, BLOCK 5, CLIFTON, KARACHI. 0300-3471646 SINDH
HUSSAIN JASDENWALA Hussainjasdenwala@123 303 B, Ezzy Villa, Syedi Hakimuddin Road, Shabbirabad Block B, Karachi. 0334-3859251 SINDH
HUSSAIN MUSHTAQ SB ( SAIFY IRON ) Saifyiron@123 LAWRENCE ROAD, KARACHI. 0300-8434053 SINDH
HUSSAIN SHABBIR SB HussainShabbirsb@123 ST-8, Block C, al-Mahallat al-Burhaniyah, , North Nazimabad, Karachi. 0300-2141933 SINDH
HUSSAIN STATIONERS ( RETAIL ) HUSSAIN.stationers@123 SHOP # 4, MOLE CHAND, DIARAM BUILDING, ROBSON ROAD, URDU BAZAR, KARACHI. 0310-2229635 SINDH
HUSSAINI HARDWARE STORE ( RETAIL ) HUSSAINI.hardwarestore@123 SHOP # 2, DHARAMSHALA BUILDING, AMBAJI VILLA ROAD, BHORAPIR, KARACHI. 0320-5372110 SINDH
HUSSANI GOODS TRANSPORT HussaniGoodstransport@123 PLOT NO 87, NEW TRUCK STAND , HALA NAKA, HYDERABAD. 0300-8371144 SINDH
HUTAIB INDUSTRIAL SOLUTIONS HutaibIndustrialsolutions@123 309, PROGRESSIVE PLAZA, BEUMOUNT ROAD, HUTAIBINDUSTRIALSOLUTIONS@gmail.com SINDH
HUZAIF IQBAL ( DIGITAL ) HUZAIF.iqbal@123 Site industrial area Near Nadra Mega center back side of sonari bank 0300-8249396 SINDH
HUZAIFA SIRAJ Huzaifasiraj@123 BILTY GHOTKI 0303-9614466 SINDH
HUZEFA SB ( MOHAMMADI MILL STORE ) MohammadiMillstore@123 OPP. F.G GIRLS HIGH SCHOOL, SADDAR, HYDERABAD. 0345-3535935 SINDH
IBADAT SHAH ( AKBARI MASJID ) Akbarimasjid@123 SELF PICK 0341-2238748 SINDH
IBRAR KHAN ( TMK TRADERS ) Tmktraders@123 SHAHAB PURA, SIALKOT. 0312-6108687 PUNJAB
ICON BUILDERS PAKISTAN IconBuilderspakistan@123 3-B, MUJAHID TOWN, OLD SHUJABAD ROAD, DISTRICT, MULTAN CANTT. SHER SHAH TOWN, MULTAN. 0311-0089999 PUNJAB
IDEAL POWER SOLUTIONS (PRIVATE) LIMITED IDEAL.powersolutions@123 D-197, BLOCK-5, K.D.A. SCHEME-2, CLIFTON, BEHIND PAK TOWERS, KARACHI. 0333-0602000 SINDH
IDREES STEEL CO C/O AANABIA MARBLE IdreesSteelCoC/OAanabiamarble@123 PLOT NO F-229, S.I.T.E, KARACHI. 0302-2737165 SINDH
IFT HOLDINGS Iftholdings@123 PLOT NO. 17-E, SIFTHIYA TOWER, 4TH FLOOR, MAIN KHAYABAN-E-ITTEHAD, PHASE-II EXT., D.H.A., KARACHI. 0312-1225960 SINDH
IFTIKHAR AHMAD Iftikharahmad@123 SHOP NO, PD02, SAID PUR ROAD NEAR PINDORA CHAUNGI, RAWALPINDI. 0333-5151645 PUNJAB
IFTIKHAR AHMED Iftikharahmed@123 PULLI TOOP KHANA, GONDAL ROAD, NEAR FAYSAL BANK, SIALKOT. 0300-1629429 PUNJAB
IFTIKHAR HUSSAIN Iftikharhussain@123 8, KHAYABAN-E-HAFIZ DHA GIZRI, KARACHI. 0301-8282234 SINDH
IFTIKHAR ULLAH ( MASHAALLAH MARBLE ) Mashaallahmarble@123 POST OFFICE KHALL, TEHSIL TEMARGARA, DISTT, LOWER DIR TIMERGARA. 0346-8000642 KPK
IJAZ AHMED SB IjazAhmedsb@123 BILTY TO LAHORE. 0300-8464540 PUNJAB
IJAZ SB ( IJAZ ELECTRIC STORE ) IjazElectricstore@123 REHMANIA BAZAR, KOHAT. 0333-6533465 KPK
IK ASSOCIATE Ikassociate@123 Plot # 30-C 3rd Floor, 12th Bukhari Comm Lane, Phase 6, Defence, Karachi 0333-2131168 SINDH
IKRAM ULLAH Ikramullah@123 HOUSE # 1, STREET-4, PHASE-II D.H.A., ISLAMABAD, HUMAK. 0344-5919463 CAPITAL TERRITORY
ILAHI GROUP OF COMPANIES ( DIGITAL ) Companiesdigital@123 PLOT 71 A, STREET 1, KHALID COMMERCIAL PHASE 7 EXT DHA OPP FATIMA MOSQUE. 0300-2606484 SINDH
ILYAAS ALI Ilyaasali@123 HOUSE NO.1552, MOHALLAH LUQMAN COLONY, FAISALABAD. 0333-6519881 PUNJAB
Ilyas Power Solution IlyasPowersolution@123 43-9/E, BLOCK-6, P.E.C.H.S., TARIQ ROAD, KARACHI EAST 0314-2000859 SINDH
IMDAD SB ( AMIR ELECTRIC H/W AND PAINT STORE ) AmirElectricH/WAndPaintstore@123 G.T. ROAD, NEAR UBL BANK, HABIBABAD, TEHSIL PATTOKI, DISTRICT KASUR. 0300-7090130 PUNJAB
IMEC ENGINEERING SOLUTIONS (PVT.) LIMITED IMEC.engineeringsolutions@123 PLOT # O3, STREET # 4000, SECTOR # 2, KORANGI INDUSTRIAL AREA, KARACHI. 0321-2922485 SINDH
IMICO (PVT.) LIMITED ( DIGITAL ) Imico(Pvt.)Limited(Digitaldigital)@123 A-403, PHASE 1 BLOCK-A, S.I.T.E AREA NOORIABAD, Hyderabad 0317-0339922 SINDH
IMPORIENT CHEMICALS (PRIVATE) LIMITED IMPORIENT.chemicals@123 T-09 HAFEEZ CENTRE GULBERG III 0300-8475673 PUNJAB
IMRAN AHSAN Imranahsan@123 HOUSE # R-4, MOHALLA 34/3 AREA, KORANGI 3, KARACHI 0322-2038685 SINDH
IMRAN ALI ( CDI ) Alicdi@123 SHOP NO.1, PROPERTY NO.93, MILLAT COLONY, COMMATTEE CHOWK, RAWALPINDI. 0333-5240249 PUNJAB
IMRAN ALI CO ZAFAR K2 CONSTRUCTION ImranAliCoZafarK2construction@123 HOUSE NO.141/17, MOHALA MUNZOOR ABAD, LAYYA, Layyah. 0322-2100247 PUNJAB
IMRAN AUTOS ( RETAIL ) IMRAN.autos@123 NEW MUZAFFARABAD COLONY, LANDHI, KARACHI. 0341-1827562 SINDH
IMRAN AZIZ ( DIGITAL ) IMRAN.aziz@123 HOUSE # 236, ST-5, ALI BLOCK, BAHRIA TOWN, LAHORE. 0345-4449119 PUNJAB
IMRAN CONSTRUCTION CO ImranConstructionco@123 G-31 E SQUARE SHOPER PLAZA, MAIN ABUL HASAN ISPHANI ROAD, KARACHI. 0333-7283977 SINDH
IMRAN ENTERPRISES Imranenterprises@123 OUT SIDE BOHAR GATE, NEAR CHOWK FAWARA, MULTAN, Multan Cantt. Sher Shah Town 0303-4859786 PUNJAB
IMRAN KHAN - NEW PAK HARDWARE SANITARY (RETAIL) Sanitaryretail@123 SHOP NO: 3, JOHAR HOME, BLOCK 13-B, GULSHANE-IQBAL, KARACHI. 0333-3131552 SINDH
IMRAN MEHBOOB Imranmehboob@123 Ghori Town, Phase 1, Flat No. 334, Street No. 17, ISLAMABAD. 0300-5115120 PUNJAB
IMRAN NAVTAKIA Imrannavtakia@123 F-50, BLOCK-8, CLIFTON, 0300-8236065 SINDH
IMRAN PAINT Imranpaint@123 PLOT NO 3/121, UPPER GIZRI, JAM SADIQ STREET, D.H.A., KARACHI. 0333-3410434 SINDH
IMRAN PAINT (RETAIL) IMRAN.paint@123 shop no B-28, block-B, iqra complex gulistan-e-johar block 17B, KARACHI. 0311-5809226 SINDH
IMRAN SANITARY SERVICE ( IMRAN TILE ) Imrantile@123 OPP IRSHAD TILE ,GOLIMAR 0320-1257266 SINDH
IMRAN SHAFQAT SB ImranShafqatsb@123 HAJI BORA SAKIKI TOWEN COMMUNITY TASEL PENDI BATYA ZELA HAFIZABAD. 0301-7069277 PUNJAB
IMRAN STEEl & CEMENT ImranSteel&cement@123 GULSAHN-E-IQBAL KARACHI 0333-2245272 SINDH
IMTIAZ AHMED SB ( IMTIAZ MARBLE ) Imtiazmarble@123 BS/16, WATER PUMP, F.B. AREA, BLOCK-16, KARACHI. 0321-9206972 SINDH
IMTIAZ MARBLE ( RPR 120 PLASTER ) IMTIAZ.marble@123 BS/16, WATER PUMP, F.B. AREA, BLOCK-16, KARACHI. 0321-9206972 SINDH
INAM AHMED ( AR ENTERPRISES ) Arenterprises@123 NEAR HBL BANK, ARAM BAGH, KARACHI. 0332-3368711 SINDH
INDOTECH AUTO PARTS IndotechAutoparts@123 OFFICE # 15, FIRST FLOOR, AURANGZEB MARKET, M.A. JINNAH Rd., KARACHI. 0323-2236525 SINDH
INDUS HOSPITAL & HEALTH NETWORK IndusHospital&Healthnetwork@123 PLOT NO. C 76, SECTOR NO. 31/5, DARUSALAM SOCIETY KORANGI CROSSING, KARACHI. 0304-6669032 SINDH
INDUS TRADING CO. C/O ZAHID CEMENT IndusTradingCo.C/OZahidcement@123 SHOP # R-193, BLOCK-5, NEAR LANDI KOTAL CHOWRANGI, KARACHI. 0321-2054138 SINDH
INDUSTRIAL ENTERPRISE Industrialenterprise@123 2-5 SIRAJ-UL-MASJID, OPP. MALIR CITY POLICE STATION, MAIN SHAHRAH-E-FAISAL, KARACHI. 0333-2115485 SINDH
INDUSTRIAL ENTERPRISES (PRIVATE) LIMITED INDUSTRIAL.enterprises@123 6-N INDUSTRIAL AREA, GULBERG II, LAHORE. 0300-8437703 PUNJAB
INNOSERVE (PVT.) LIMITED INNOSERVE.@123 A-333, SECTOR-6 F, MEHRAN TOWN, KORANGI INDUSTRIAL AREA, KARACHI. 0312-8331955 SINDH
INNOVARCH DESIGN AND BUILD InnovarchDesignAndbuild@123 SECOND FLOOR, PLOT NO 9C,, SEHAR COMMERCIAL,, LANE 8, PHASE-VII, DHA KARACHI. 0321-3870730 SINDH
INNOVATIVE CONSTRUCTION Innovativeconstruction@123 FLAT # 301-A, PHASE-II, 3rd FLOOR, FLOURISH VIEW, SECTOR 11/A, NORTH KARACHI. 0321-8957746 SINDH
INSERVEY PAKISTAN (PRIVATE) LIMITED INSERVEY.pakistan@123 PLOT # 20, STREET-17, D.H.A, PHASE-5, KARACHI. 0314-2031126 SINDH
INTEGRATION LOGICS CO DANISH ( DIGITAL ) Danishdigital@123 HOUSE NO. 71 DEFENCE HOUSING SOCIETY MALIR CANTT PHASE.1, KARACHI. 0307 2324445 SINDH
Intercon construction ( DIGITAL ) Constructiondigital@123 Intercon construction collect from the cargo office near Faizabad Islamabad. 0340-5259929 PUNJAB
INTERCON CONSTRUCTION PARTNERS InterconConstructionpartners@123 53-BII, PGECHS WAPDA TOWN, LAHORE. 0304-4180964 PUNJAB
INTERNATIONAL BRANDS (PRIVATE) LIMITED INTERNATIONAL.brands@123 3RD FLOOR, ONE IBL CENTRE, TIPU SULTAN ROAD OFF SHAHRAH-E-FAISAL, KARACHI EAST. 0341-2522646 SINDH
INTERNATIONAL FRANCHISES (PRIVATE) LIMITED INTERNATIONAL.franchises@123 GROUND FLOOR SHOP A4/8, A4/9 AND A4/10, PLOT# FL-5, BLOCK 4, SITUATED AT KDA SCHEME NO. 24 ,GULSHAN IQBAL, KARACHI. 0332-2369065 SINDH
`;

const KNOWN_STATES = /^(SINDH|PUNJAB|KPK|BALOCHISTAN|CAPITAL TERRITORY|AFG|UAE|EXPORT)$/i;
const MOBILE_RE = /^0?\d{2,4}-\d{6,8}$/;

function parseLine(line) {
  const parts = line.split(/\s{2,}/);
  if (parts.length >= 5) {
    let state = "";
    let mobile = "";
    const stateVal = parts[parts.length - 1];
    if (KNOWN_STATES.test(stateVal)) {
      state = stateVal.toUpperCase();
      parts.pop();
    }
    if (parts.length >= 1 && MOBILE_RE.test(parts[parts.length - 1])) {
      mobile = parts.pop();
    }
    const name = parts[0].trim();
    const password = parts[1].trim();
    const address = parts.slice(2).join(" ").trim();
    return { name, password, address, mobile, state };
  }
  const tokens = line.split(/\s+/);
  if (tokens.length < 3) return null;
  let state = "";
  let mobile = "";
  if (KNOWN_STATES.test(tokens[tokens.length - 1])) {
    state = tokens.pop().toUpperCase();
  }
  if (tokens.length >= 1 && MOBILE_RE.test(tokens[tokens.length - 1])) {
    mobile = tokens.pop();
  }
  const pwdIdx = tokens.findIndex((t) => t.includes("@"));
  if (pwdIdx < 0) return null;
  const name = tokens.slice(0, pwdIdx).join(" ").trim();
  const password = tokens[pwdIdx];
  const address = tokens.slice(pwdIdx + 1).join(" ").trim();
  return { name, password, address, mobile, state };
}

function parseBulkData(text) {
  const lines = text.trim().split("\n").map((l) => l.trim()).filter(Boolean);
  const rows = [];
  for (const line of lines) {
    const row = parseLine(line);
    if (row && row.name && row.password) rows.push(row);
  }
  return rows;
}

function slugToEmail(slug, existingEmails) {
  const base = slug.replace(/[^a-z0-9]/gi, ".").replace(/\.+/g, ".").replace(/^\.|\.$/g, "").toLowerCase().slice(0, 40) || "customer";
  let email = `${base}@ressichem.local`;
  let n = 0;
  while (existingEmails.has(email)) {
    n++;
    email = `${base}.${n}@ressichem.local`;
  }
  existingEmails.add(email);
  return email;
}

function extractCityFromAddress(address, state) {
  const lower = address.toLowerCase();
  const cities = ["karachi", "lahore", "islamabad", "rawalpindi", "peshawar", "quetta", "faisalabad", "gujranwala", "sialkot", "hyderabad", "multan", "mardan", "wah", "taxila", "bannu", "larkana", "shikarpur", "turbat", "mingora", "sawat", "chak", "jhang", "bhakkar", "renala", "chiniot", "pattoki", "gujrat", "sahiwal"];
  for (const city of cities) {
    if (lower.includes(city)) return city.charAt(0).toUpperCase() + city.slice(1);
  }
  if (state === "SINDH") return "Karachi";
  if (state === "PUNJAB") return "Lahore";
  if (state === "KPK") return "Peshawar";
  if (state === "BALOCHISTAN") return "Quetta";
  return "Pakistan";
}

async function run() {
  if (!MONGODB_URI) {
    console.error("âŒ CONNECTION_STRING or MONGODB_URI not set in .env");
    process.exit(1);
  }

  await mongoose.connect(MONGODB_URI);
  console.log("âœ… Connected to MongoDB\n");

  const rows = parseBulkData(BULK_DATA);
  console.log(`ðŸ“‹ Parsed ${rows.length} rows (missing-customers batch only)\n`);

  const usedEmails = new Set();
  let created = 0;
  let skipped = 0;
  let errors = 0;

  for (const row of rows) {
    const email = slugToEmail(row.password.replace(/@\d+$/, ""), usedEmails);
    const contactName = row.name.length > 80 ? row.name.slice(0, 77) + "..." : row.name;
    const companyName = contactName;

    try {
      const existingCustomer = await Customer.findOne({
        company_id: COMPANY_ID,
        $or: [{ email }, { companyName: companyName.slice(0, 50) }],
      });
      if (existingCustomer) {
        skipped++;
        continue;
      }

      const customer = new Customer({
        companyName,
        contactName,
        email,
        phone: row.mobile || "0300-0000000",
        street: row.address || "Address not provided",
        city: extractCityFromAddress(row.address, row.state),
        state: row.state,
        country: COUNTRY,
        company_id: COMPANY_ID,
        status: "active",
        customerType: "regular",
      });
      await customer.save();

      const existingUser = await User.findOne({ email, company_id: COMPANY_ID });
      if (existingUser) {
        customer.user_id = existingUser._id;
        await customer.save();
        created++;
        continue;
      }

      const hashedPassword = await bcrypt.hash(row.password, 10);
      const nameParts = contactName.split(/\s+/);
      const firstName = nameParts[0] || "Customer";
      const lastName = nameParts.slice(1).join(" ") || "User";

      const user = new User({
        user_id: `customer_${customer._id}`,
        email,
        password: hashedPassword,
        firstName,
        lastName,
        phone: row.mobile,
        role: "Customer",
        department: "Customer",
        company_id: COMPANY_ID,
        isCustomer: true,
        isActive: true,
        customerProfile: {
          customer_id: customer._id,
          companyName,
          customerType: "regular",
        },
      });
      await user.save();

      customer.user_id = user._id;
      await customer.save();
      created++;
      console.log(`âœ… ${companyName.slice(0, 50)} | ${email} | ${row.password}`);
    } catch (err) {
      errors++;
      console.error(`âŒ ${companyName?.slice(0, 40)}:`, err.message);
    }
  }

  console.log(`\nâœ… Done. Created: ${created}, Skipped: ${skipped}, Errors: ${errors}`);

  await mongoose.disconnect();
  process.exit(errors > 0 ? 1 : 0);
}

run().catch((err) => {
  console.error(err);
  process.exit(1);
});
